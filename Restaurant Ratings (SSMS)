#In this SQL, I am querying from multiple tables from the database I found on Kaggle. This SQL is to find the rating's statistics from the restaurants data.

--I created each of the tables:

CREATE TABLE ratings (
Consumer_ID varchar(50),
Restaurant_ID int,
Overall_Rating int,
Food_Rating int,
Service_Rating int
)

CREATE TABLE consumer_preferences (
Consumer_ID	varchar (50),
Preferred_Cuisine (50)
)

CREATE TABLE consumers (
Consumer_ID varchar(50),
City varchar(50) NOT NULL,
State varchar(50) NOT NULL,
Country varchar(50) NOT NULL,
Latitude float NOT NULL,
Longitude float NOT NULL,
Smoker BIT NULL,
Drink_Level varchar(50) NOT NULL,
Transportation_Method varchar(50) NULL,
Marital_Status varchar(50) NULL,
Children varchar(50) NULL,
Age varchar, NOT NULL,
Occupation varchar(50), NULL,
Budget varchar(50) NULL
)

CREATE TABLE restaurant_cuisines (
Restaurant_ID int NOT NULL,
Cuisine varchar(50) NOT NULL
)

CREATE TABLE restaurant (
Restaurant_ID int NOT NULL,
Name varchar (100) NOT NULL,
City varchar(50) NOT NULL,
State varchar(50) NOT NULL,
Country varchar(50) NOT NULL,
Zip_Code int NULL,
Latitude float NOT NULL,
Longitude float NOT NULL,
Alcohol_Service varchar(50) NOT NULL,
Smoking_Allowed varchar(50) NOT NULL,
Price varchar(50) NOT NULL,
Franschise bit NOT NULL,
Area varchar(50) NOT NULL,
Parking varchar(50) NOT NULL
)

--Import data

--I started doing data exploration and found interesting data, and came up with a few questions:

#Which restaurants are franchise?
SELECT Franchise, Name
FROM SQL.dbo.restaurants
WHERE Franchise ='1';

#What is the average overall rating for the restaurants that offers no alcochol or smoking allowed?
SELECT 
    AVG(ratings.Overall_Rating) AS Average_Rating,
    restaurants.Alcohol_Service,
    restaurants.Smoking_Allowed
FROM SQL.dbo.ratings 
LEFT JOIN SQL.dbo.restaurants 
	ON ratings.Restaurant_ID = restaurants.Restaurant_ID
WHERE restaurants.Alcohol_Service = 'None'
AND restaurants.Smoking_Allowed = 'No'
GROUP BY restaurants.Alcohol_Service, restaurants.Smoking_Allowed;

#What is the top 5 preferred cuisine?
SELECT TOP 5 Preferred_Cuisine AS Most_Preferred_Cuisine, COUNT(Preferred_Cuisine) AS Preference_Count
FROM SQL.dbo.consumer_preferences
GROUP BY Preferred_Cuisine
ORDER BY Preference_Count DESC;

#What is the transportation method of the consumers?
SELECT 
    CASE 
        WHEN Transportation_Method = 'On foot' THEN 'On foot'
        WHEN Transportation_Method = 'Car' THEN 'By car'
        WHEN Transportation_Method = 'Public' THEN 'Public'
    END AS Transportation_Method,
    COUNT(*) AS Count_of_Consumers
FROM SQL.dbo.consumers
WHERE Transportation_Method IN ('On foot', 'Car', 'Public')
GROUP BY Transportation_Method;


#How can this answer business problems or help a business out?
--Example: First I used SQL to calculate various consumers metrics such as which restaurants are franchise.
--These metrics are essential in identifying high- value consumers because franchise restaurants has many benefits. This is a popular way 
for businesses to expand their reach and grow their brand and contributing significantly to the company's revenue.

--Next I utilized SQL to implement data that categorize the average rating for restaurants that offer no alcohol or smoking allowed. 
I received this data from two different tables to find the average rating. 
--This would help businesses ultimately decide if providing alcohol and allowed smoking would affect the overall rating or not.

--Then I used SQL to group together the consumer's preferences on their preferred cuisines and transportation methods.
--This data is key to make business decisions accordingly.

--Furthermore, I created SQL queries to generate visualizations, such as circle charts, pie charts, and text charts, to illustrate the
distribution of consumer's segments and their corresponding contributions to the company's revenue.

--Finally, I presented the findings in a comprehensive report utilizing Tableau, highlighting the unique characteristics of each consumer's 
segment and providing actionable recommendation for targeted marketing campaigns. By leveraging SQL to perform consumers segmentation, the 
restaurants businesses gained valuable insights into its consumer based, enabling them to talor marketing strategies, improve consumer 
retention, and optimize revenue generation.
