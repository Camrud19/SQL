#In this SQL, I'm querying a database to find the murder from Murder Mystery!!


#This lead me to find the two witness at the crime scene:
SELECT *
FROM crime_scene_report
WHERE city LIKE 'SQL City'
AND date LIKE '20180115'
AND type LIKE 'murder';
--Security footage shows that there were 2 witnesses. The first witness lives at the last house on "Northwestern Dr". The second witness, named Annabel, lives somewhere on "Franklin Ave".

#First witness name is Morty Schapiro:
SELECT *
FROM person
WHERE address_street_name LIKE 'Northwestern Dr'
ORDER BY address_number desc
LIMIT 1;

#Second witness name is Annabel Miller:
SELECT *
FROM person
WHERE address_street_name LIKE 'Franklin Ave'
AND name LIKE 'Annabel%';

--I used their interview statements to dig deeper, I took their id number that was listed in the 'person' table and inputted that to find their transcript.
#Marty Schaprio and Annabel Miller's interview statements:
SELECT name, transcript
FROM person JOIN interview
ON person.id = interview.person_id
WHERE person.id = 14887 OR person.id = 16371;
--I got both of their id numbers when I ran the query to find their addresses in the "person" table. I used that piece of information to find their interview transcripts.

--Now I got more information from both witnesses. I'll use both of their descriptions to dig deeper based on their statements.

#This query helped me narrow down who the murder could be. Annabel Miller stated that she saw the suspect on Janurary 9th while she was working. Marty Schaprio also stated that he saw the suspect run out after the gunshot occured and provided the first three numbers/letters of his membership id on his bag. He stated that only gold members have those bags. This helped me narrow my seach: 
SELECT *
FROM get_fit_now_check_in
JOIN get_fit_now_member
ON get_fit_now_check_in.membership_id = get_fit_now_member.id
WHERE membership_id LIKE '48Z%'
AND check_in_date LIKE '20180109';
--I got the name of Joe Germuska and 	Jeremy Bowers, they both checked in at Get Fit on 1/9, but we have to condense our seach because the murder occured on 1/15.
--I also took note of their person_id number so I can look at other tables with their number.
--Joe Germuska person_id is 28819
--Jermey Bowers person_id is 67318

#Checking to see if either suspect checked in at Get Fit on the day of the murder:
SELECT *
FROM get_fit_now_check_in
WHERE check_in_date LIKE '20180115';
--Both of them did not check in at Get Fit on the day of the murder on 1/15.

#I'm going to use Marty Schaprio statement about the license plate. He stated the man got into a car with a plate that included "H42W":
SELECT *
FROM drivers_license
WHERE plate_number LIKE '%H42W%'
AND gender LIKE 'male';
--There are two options that has that included in their license plate, it could be either of the men, we have to narrow the search more.

#I searched who checked into an event on Facebook:
SELECT *
FROM get_fit_now_check_in
WHERE check_in_date LIKE '20180115'
--Jermey Bowers checked into The Funky Grooves Tour on 1/15. We don't know for sure if he was actually at that event. It could be because he needed an alibi.

#I needed to pull up Jeremy's transcipt:
SELECT *
FROM interview
WHERE person_id LIKE '67318';
--"I was hired by a woman with a lot of money. I don't know her name but I know she's around 5'5" (65") or 5'7" (67"). She has red hair and she drives a Tesla Model S. I know that she attended the SQL Symphony Concert 3 times in December 2017."
--This gave us HUGE evidence that Jermey was involved in the murder.
--I tried running Joe Germuska's interview transcript but nothing popped up under his name.

INSERT INTO solution VALUES (1, 'Jeremy Bowers');
SELECT value FROM solution;
--Finally, we know that Jermey Bowers was behind the murder on Janurary 15, 2018 that took place in SQL City.
--Based on Jeremy's interview statement the real villian that was behind this murder is still out there.
--Let's start digging to find out who this women is that hired Jeremy to do this crime for her!!

#Running this query, we know that her id number is 918773:
SELECT *
FROM drivers_license
WHERE hair_color LIKE 'red'
AND gender LIKE 'female'
AND height LIKE '65'
AND car_make LIKE 'Tesla';

#We know that Jeremy stated that she went to the SQL Symphony Concert 3 times in December 2017:
SELECT *
FROM facebook_event_checkin
WHERE event_id LIKE '1143'
AND date LIKE '2017%17';
-There was three person_id that pulled up connecting to this event. We have to find out who the person_id belongs to.

#Putting this query allows us to view all three of the names:
SELECT *
FROM person
WHERE id LIKE '58898'
OR id LIKE '62842'
OR id LIKE '93808'
--We know that are villan is a women. This query pulled up two women and one men, we have to do more digging!
--We can eliminate person_id number 93808, this belongs to Kraig Heading.
--We have Berta Cohick person_id number 62842 and Enedina Cassells person_id number 58898.

#I checked to see if she is a member at Get Fit with her id number:
SELECT *
FROM get_fit_now_member
WHERE id LIKE '918773';
--She is not a member.

#I checked both of their interview transcripts to see if that will give us any clues:
#Berta Cohick's interview statement:
SELECT *
FROM interview
WHERE person_id LIKE '62842';
--"There was a long silence after this, and Alice could only hear whispers"

#Enedina Cassells's interview statement:
SELECT *
FROM interview
WHERE person_id LIKE '58898';
--"question, you know.â€™"

--Both didn't give us any specific clues regarding the murder.

#Referring back to Jermey Bowers's interview statement, he stated that he was hired by a women who makes a lot of money. We need to do digging on both of these women annual income:
SELECT *
FROM person
JOIN income
ON person.ssn = income.ssn
WHERE id LIKE '58898'
OR id LIKE '62842';
--Base on this information, we know that Enedina Cassells makes $86,300 annually.
--Berta Cohick makes $22,500 annually.

INSERT INTO solution VALUES (2, 'Jeremy Bowers, Enedina Cassells');
SELECT value FROM solution;

#YAYYY! I caught the murder (Jeremy Bowers) and the villian (Enedina Cassells)!!
